# словарь друзей и городов в которых они проживают 
DATABASE = {
    'Сергей': 'Омск',
    'Соня': 'Москва',
    'Миша': 'Москва',
    'Дима': 'Челябинск',
    'Алина': 'Красноярск',
    'Егор': 'Пермь',
    'Коля': 'Красноярск'
}


# 5-я ф-ция
# функциф которая опр. окончание ответа на вопрос сколько у тебя друзей
def format_friends(friends_count):  # объявляем функцию с условием/переменной friends_count
    if friends_count == 1: # если 1 друг то возвразщаем 'У тебя N друг'
        return 'У тебя 1 друг'  # возращаем 'У тебя N друг'
    elif 2 <= friends_count <= 4:  # если от 2х до 4х друзей возвращаем 'У тебя N друга'
        return 'У тебя ' + str(friends_count) + ' друга'  # возвращаем 'У тебя N друга'
    elif friends_count >= 5:   # если 5 и больше возвращаем 'У тебя N друзей'
        return 'У тебя ' + str(friends_count) + ' друзей'   # возвращаем 'У тебя N друзей'

# 4-я ф-ция
# Работаем с БД, отвечаем на вопросы
def process_anfisa(query):    # объявляем ф-цию
    if query == 'сколько у меня друзей?':   # если вопрос ...
        count_string = format_count_friends(len(DATABASE))  # считаем к-во записей в словааре
        return f'У тебя {count_string}'   # возвращаем значение кол-во записей
    elif query == 'кто все мои друзья?':   # если вопрос ...
        friends_string = ', '.join(DATABASE.keys())   # берем все ключи из словаря и записываем через запятую 
        return f'Твои друзья: {friends_string}'   # возвращаем перечень ключей/имен 
    elif query == 'где все мои друзья?':   # если вопрос ....
        unique_cities = set(DATABASE.values())   # берем все значения ключей из словаря
        cities_string = ', '.join(unique_cities)   # записываем значения ключей через запятую
        return f'Твои друзья в городах: {cities_string}'   # возвращаем ответ 
    else:   # иначе обработка ошибки 
        return '<неизвестный запрос>'  # возвращаем не известный запрос 


# 1-я ф-ция
# функция со списком вопросов к анфисе  
def runner():  # объявление функции 
    queries = [      # название списка и содержимое     
        'Анфиса, сколько у меня друзей?',
        'Анфиса, кто все мои друзья?',
        'Анфиса, где все мои друзья?',
        'Анфиса, кто виноват?',
        'Коля, ты где?',
        'Соня, что делать?',
        'Антон, ты где?'
    ]
    for query in queries:   # цикл в котором перебераютсявсе элементы списка  
        print(query, '-', process_query(query))   # отправляем вопрос на обрабоку во 2ю ф-цию
    
    
# 2-я ф-ция        
# ф-ция которая опр. кому адресован вопрос 
def process_query(query):  # ф-ция определяющая кому адресовон вопрос  
    tokens = query.split(', ')   # делим элементы списка по запятой 
    name = tokens[0]   # берем нулевой элемент списка 
    if name == 'Анфиса':  # если нулевой элемент равен "Анфиса"
        return process_anfisa(tokens[1])   # возвращаем в 4ю ф-цию 
    else:    # иначе 
        return process_friend(name, tokens[1])   # возврщаем в 3ю ф-цию
           
 
# 3-я ф-ция       
# поиск друзей по имени        
def process_friend(name, query):   # поиск друга по имени в городе 
    if name in DATABASE:   # перебираем имена друзей в БД 
        if query == 'ты где?':   # есть совпадение по имени, вопрос "ты где"
            city = DATABASE[name]   # перебираем города в котором встречается имя переданное с этим вопросом 
            print(f'{name} в городе {city}')   # выводим ответ 
            return f'{name} в городе {city}'   # возвращаем ответ 
        else:  # иначе 
            return '<неизвестный запрос>'   # обработка ошибок 
    else:    # иначе 
        return f'У тебя нет друга по имени {name}'  # совподений по имени не найдено 
    
runner()
